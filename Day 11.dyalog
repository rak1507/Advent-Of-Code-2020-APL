a←↑⊃⎕NGET'Day 11.txt' 1
s←'.'≠a

⍝ Part 1
+/,{s∧⊃1 ⍵∨.∧1 5∘.>⊂{+/,⍵}⌺3 3⊢⍵}⍣≡'#'=a

⍝ Part 2
r←↑↑{⍸0@(⊂11 11)∧/↑(⊂0 ⍵)∊⍨¨|11-⍳21 21}¨⍳10
+/,{s∧⊃1 ⍵∨.∧1 5∘.>⊂{{+/,2=⍵×<⍀0≠⍵}r⌷⍤1 99⍤99 2⊢⍵}⌺23 23⊢s+⍵}⍣≡⊢'#'=a
