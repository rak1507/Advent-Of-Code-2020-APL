⎕FR←1287 ⋄ ⎕PP←20
(b n)←⊃⎕NGET'Day 13.txt' 1
b←⍎b ⋄ x←0 ⋄ n←⍎¨','(≠⊆⊢)n
i←n⍳n~0 ⋄ n←n~0

⍝ Part 1
b {(⍵⊃⍨⊃⍋m)×⍺-⍨⌊/m←⍵×⌈⍺÷⍵} n

⍝ Part 2
m←(⊣|∘⊃{0=⍵:1 0 ⋄ (⍵∇⍵|⍺)+.×0 1,⍪1,-⌊⍺÷⍵}⍨) ⍝ APLcart
crt←{p←⍺÷⍨×/⍺ ⋄ (×/⍺)|+/⍵×p×m/¨↓⍉↑⍺p}
n crt n-i-1
