a←⊃⎕NGET 'Day 18.txt' 1
eval←{⍎{1=≢⍵:⍵ ⋄ ⍕⍎prec⊃,/⌽∇¨⊃,/,/¨t⊂⍨~¯1⌽0<+\1 ¯1 0[(,¨'()')⍳t←60⌶1↓¯1↓⍵]}'\*'⎕R'×'⊢'(',⍵,')'}

⍝ Part 1
prec←⊢ ⋄ +/eval¨a

⍝ Part 2
prec←'((?:\d+\+)+\d+)'⎕R'(\1)' ⋄ +/eval¨a
